{% extends 'base.html' %}

{% block title %}
    Users
{% endblock %}

{% block head %}
    <style>
    .ticket_queue table{
        width: 800px;
        margin: 0 auto;
    }

    .ticket_queue h3{
        text-align: center;
    }

    div.table-head{
        width: 800px;
        margin: 0 auto;
    }

    button a{
        text-decoration: none;
        color: rgb(227, 204, 4);
        width: 100%;
        height: 100%;
    }


    </style>

{% endblock %}
{% block body %}
    <div class="ticket_queue">
        <div class="table-head">
            <h3>Active Users</h3>
            <div class="new-user-btn">
                <button onclick="location.href='{{ url_for("add_user_2") }}'">Add New User</button>
            </div>
        </div>
        <table class="table" width="500" cellpadding="10" cellspacing="0" align="center">
            <thead>
                <tr>
                    <td>ID</td>
                    <td>Level</td>
                    <td>Username</td>
                    <td>Name</td>
                    <td>Email</td>
                    <td>Commands</td>
                </tr>
            </thead>
            <tbody>
                {% for t in actives %}
                    <tr>
                        <td>{{ t.id }}</td>
                        <td>{{ t.level }}</td>
                        <td>{{ t.username }}</td>
                        <td>{{ t.first_name + ' ' + t.last_name }}</td>
                        <td>{{ t.email }}</td>
                        <td>
                            <button><a href="{{ url_for('edit_user_2', id=t.id) }}">Edit</a></button>
                            <button id="deactive_user" post_url="{{ url_for('deactive_2', id=t.id) }}" user_id="{{ t.id }}">Deactivate</button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>

        </table>
        <h3>Inactive Users</h3>
        <table class="table" width="500" cellpadding="10" cellspacing="0" align="center">
            <thead>
                <tr>
                    <td>ID</td>
                    <td>Level</td>
                    <td>Username</td>
                    <td>Name</td>
                    <td>Email</td>
                    <td>Commands</td>
                </tr>
            </thead>
        <tbody>
            {% for t in inactives %}
                <tr>
                    <td>{{ t.id }}</td>
                    <td>{{ t.level }}</td>
                    <td>{{ t.username }}</td>
                    <td>{{ t.first_name + ' ' + t.last_name }}</td>
                    <td>{{ t.email }}</td>
                    <td>
                        <button id="active_user" post_url="{{ url_for('active_2', id=t.id) }}">Activate</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
    <script>
        $(document).ready(function () {
            $("button#deactive_user").click(function () {
                var user_id = $(this).attr("user_id");
                var url = $(this).attr("post_url");
                if(confirm("Are you sure to deactivate?")){
                    $.ajax({
                        url: url,
                        method: "post",
                        success: function (status, data) {
                            location.reload();
                        },
                        error: function (status, data) {
                            alert("Failed to deactivate!");
                        }
                    })
                }
            });
            $("button#active_user").click(function () {
                var user_id = $(this).attr("user_id");
                var url = $(this).attr("post_url");
                if(confirm("Are you sure to activate?")){
                    $.ajax({
                        url: url,
                        method: "post",
                        success: function (status, data) {
                            location.reload();
                        },
                        error: function (status, data) {
                            alert("Failed to activate!");
                        }
                    })
                }
            });
        })
    </script>

{% endblock %}