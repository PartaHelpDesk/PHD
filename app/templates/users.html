{% extends 'base.html' %}

{% block title %}
    Users
{% endblock %}

{% block head %}
    <style>
    .ticket_queue table{
        width: 800px;
        margin: 0 auto;
    }

    .ticket_queue h3{
        text-align: center;
    }

    div.table-head{
        width: 800px;
        margin: 0 auto;
    }

    button a{
        text-decoration: none;
        color: rgb(227, 204, 4);
        width: 100%;
        height: 100%;
    }

    </style>

{% endblock %}
{% block body %}
    <div class="ticket_queue">
        <div class="table-head">
            <div class="new-user-btn" ></div>
            <div class="new-user-btn" align="left">
                <button><a href="{{ url_for('add_user') }}">Add New User</a></button>
            </div>
            <h3 align="center">Active Users</h3>
        </div>
        <table class="table" width="500" cellpadding="10" cellspacing="0" align="right">
            <thead>
                <tr>
                    <td>ID</td>
                    <td>Level</td>
                    <td>Name</td>
                    <td>Username</td>
                    <td>Email</td>
                    <td>Commands</td>
                </tr>
            </thead>
            <tbody>
                {% for u in active_users %}
                    <tr>
                        <td>{{ u.user_id }}</td>
                        {% if u.level=='1' %}
                            <td>User</td>
                        {% elif u.level == '2' %}
                            <td>IT</td>
                        {% elif u.level == '3' %}
                            <td>Admin</td>
                        {% endif %}
                        <td>{{ u.first_name + ' ' + u.last_name }}</td>
                        <td>{{ u.username }}</td>
                        <td>{{ u.email }}</td>
                        <td>
                            <button><a href="{{ url_for('edit_user', id=u.user_id) }}">Edit</a></button>
                            <button id="deactive_user" post_url="{{ url_for('deactive', id=u.user_id) }}">Deactivate</button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>

        </table>
        <h3 align="left">Inactive Users</h3>
        <table class="table" width="500" cellpadding="10" cellspacing="0" align="left">
            <thead>
                    <tr>
                        <td>ID</td>
                        <td>Level</td>
                        <td>Name</td>
                        <td>Username</td>
                        <td>Email</td>
                        <td>Commands</td>
                    </tr>
            </thead>
        <tbody>
            {% for u in inactive_users %}
                <tr>
                    <td>{{ u.user_id }}</td>
                    {% if u.level=='1' %}
                        <td>User</td>
                    {% elif u.level == '2' %}
                        <td>IT</td>
                    {% elif u.level == '3' %}
                        <td>Admin</td>
                    {% endif %}
                    <td>{{ u.first_name + ' ' + u.last_name }}</td>
                    <td>{{ u.username }}</td>
                    <td>{{ u.email }}</td>
                    <td>
                        <button><a href="{{ url_for('edit_user', id=u.user_id) }}">Edit</a></button>
                        <button id="active_user" post_url="{{ url_for('active', id=u.user_id) }}">Activate</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
    <script>
        $(document).ready(function () {
            $("button#deactive_user").click(function () {
                var user_id = $(this).attr("user_id");
                var url = $(this).attr("post_url");
                if(confirm("Are you sure to deactivate?")){
                    $.ajax({
                        url: url,
                        method: "post",
                        success: function (status, data) {
                            location.reload();
                        },
                        error: function (status, data) {
                            alert("Failed to deactivate!");
                        }
                    })
                }
            });
            $("button#active_user").click(function () {
                var user_id = $(this).attr("user_id");
                var url = $(this).attr("post_url");
                if(confirm("Are you sure to activate?")){
                    $.ajax({
                        url: url,
                        method: "post",
                        success: function (status, data) {
                            location.reload();
                        },
                        error: function (status, data) {
                            alert("Failed to activate!");
                        }
                    })
                }
            });
        })
    </script>

{% endblock %}

